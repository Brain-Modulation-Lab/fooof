<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Creating Synthetic Power Spectra &#8212; fooof 1.0.0-dev documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          fooof</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.0-dev</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="../glossary.html">Glossary</a></li>
                <li><a href="../auto_tutorials/index.html">Tutorial</a></li>
                <li><a href="index.html">Examples</a></li>
                <li><a href="../contents.html">Index</a></li>
                <li><a href="https://github.com/voytekresearch/fooof">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-synthetic-power-spectra-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="creating-synthetic-power-spectra">
<span id="sphx-glr-auto-examples-plot-synthetic-power-spectra-py"></span><h1>Creating Synthetic Power Spectra<a class="headerlink" href="#creating-synthetic-power-spectra" title="Permalink to this headline">¶</a></h1>
<p>Use FOOOF to create synthetic power spectra.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import fooof functions for creating synthetic power spectra</span>
<span class="kn">from</span> <span class="nn">fooof.synth.gen</span> <span class="kn">import</span> <span class="n">gen_power_spectrum</span><span class="p">,</span> <span class="n">gen_group_power_spectra</span>

<span class="c1"># Import some fooof plotting functions</span>
<span class="kn">from</span> <span class="nn">fooof.plts.spectra</span> <span class="kn">import</span> <span class="n">plot_spectrum</span><span class="p">,</span> <span class="n">plot_spectra</span>
</pre></div>
</div>
<div class="section" id="id1">
<h2>Creating Synthetic Power Spectra<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>FOOOF has utilities to create synthetic power spectra, whereby spectra
are simulated with an aperiodic component with overlying peaks,
using specified parameters.</p>
<p>The <code class="xref py py-func docutils literal notranslate"><span class="pre">gen_power_spectrum()</span></code> function can be used to synthesize a power
spectrum with specified parameters.</p>
<p>Note that all FOOOF functions that synthesize power spectra take in
gaussian parameters, not the modified peak parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for creating a synthetic power spectrum</span>
<span class="n">freq_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>            <span class="c1"># The frequency range to simulate</span>
<span class="n">aperiodic_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>       <span class="c1"># Parameters defining the aperiodic component</span>
<span class="n">gaussian_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Parameters for any periodic components</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a synthetic power spectrum</span>
<span class="n">fs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">gen_power_spectrum</span><span class="p">(</span><span class="n">freq_range</span><span class="p">,</span> <span class="n">aperiodic_params</span><span class="p">,</span> <span class="n">gaussian_params</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the synthetic power spectrum</span>
<span class="n">plot_spectrum</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">log_freqs</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">log_powers</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_synthetic_power_spectra_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_synthetic_power_spectra_001.png" />
</div>
<div class="section" id="simulating-with-different-parameters">
<h2>Simulating With Different Parameters<a class="headerlink" href="#simulating-with-different-parameters" title="Permalink to this headline">¶</a></h2>
<p>Power spectra can be synthesized with any desired parameters for the FOOOF power spectra model.</p>
<p>The aperiodic mode for the simulated power spectrum is inferred from the parameters provided.
If two parameters are provided, this is interpreted as [offset, exponent] for simulating
a power spectra with a ‘fixed’ aperiodic component. If three parameters are provided, as in
the example below, this is interpreted as [offset, knee, exponent] for a ‘knee’ spectrum.</p>
<p>Power spectra can also be simulated with any number of peaks. Peaks can be listed in a flat
list with [center frequency, amplitude, bandwidth] listed for as many peaks as you would
like to add, or as a list of lists containing the same information.</p>
<p>The following example shows simulating a different power spectrum with some different
parameter settings, also changing the noise level added to the spectrum, and the frequency
resolution of the simulated spectrum.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up new settings for creating a different synthetic power spectrum</span>
<span class="n">freq_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="n">aperiodic_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>            <span class="c1"># Specify three values as [offset, knee, exponent]</span>
<span class="n">gaussian_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># Add peaks - can also be [[9, 0.4, 1], [24, 0.2, 3]]</span>
<span class="n">nlv</span> <span class="o">=</span> <span class="mf">0.01</span>                                 <span class="c1"># The amount of noise to add to the spectrum</span>
<span class="n">freq_res</span> <span class="o">=</span> <span class="mf">0.25</span>                            <span class="c1"># Specific the frequency resolution to simulate</span>

<span class="c1"># Generate the new synthetic power spectrum</span>
<span class="n">fs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">gen_power_spectrum</span><span class="p">(</span><span class="n">freq_range</span><span class="p">,</span> <span class="n">aperiodic_params</span><span class="p">,</span> <span class="n">gaussian_params</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">freq_res</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the new synthetic power spectrum</span>
<span class="n">plot_spectrum</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">log_powers</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_synthetic_power_spectra_002.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_synthetic_power_spectra_002.png" />
</div>
<div class="section" id="simulating-a-group-of-power-spectra">
<h2>Simulating a Group of Power Spectra<a class="headerlink" href="#simulating-a-group-of-power-spectra" title="Permalink to this headline">¶</a></h2>
<p>For simulating multiple power spectra, the <code class="xref py py-func docutils literal notranslate"><span class="pre">gen_group_power_spectrum()</span></code> can be used.</p>
<p>This function takes the same kind of parameter definitions as <code class="xref py py-func docutils literal notranslate"><span class="pre">gen_power_spectrum()</span></code>,
and in addition takes a number specifying how many power spectra to simulate, returning
a 2D matrix containing the desired number of spectra.</p>
<p>For each parameter that is specified, it can be a single definition, in which case
this value is used to generate each spectrum, a list of parameters, in which case
each successive entry is used to generate each successive power spectrum, or
a function or generator that can be called to return parameters for each spectrum.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create some new settings for synthesizing a group of power spectra</span>
<span class="n">n_spectra</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">freq_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="n">ap_params</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]]</span>
<span class="n">gauss_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">nlv</span> <span class="o">=</span> <span class="mf">0.02</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Synthesize a group of power spectra</span>
<span class="n">fs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">syn_params</span> <span class="o">=</span> <span class="n">gen_group_power_spectra</span><span class="p">(</span><span class="n">n_spectra</span><span class="p">,</span> <span class="n">freq_range</span><span class="p">,</span> <span class="n">ap_params</span><span class="p">,</span> <span class="n">gauss_params</span><span class="p">,</span> <span class="n">nlv</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the power spectra that were just generated</span>
<span class="n">plot_spectra</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">log_freqs</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">log_powers</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_synthetic_power_spectra_003.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_synthetic_power_spectra_003.png" />
<p>Note that when you simulate a group of power spectra, FOOOF returns SynParam objects that
keep track of the simulations. This, and other utilties to manage parameters and provide
parameter definitions for synthesizing groups of power spectra are covered in the
<cite>Synthetic Parameters</cite> example.</p>
<p><strong>Total running time of the script:</strong> ( 0 minutes  0.031 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-synthetic-power-spectra-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/70e66d50aa19dd1b16825c8b2fb2d742/plot_synthetic_power_spectra.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_synthetic_power_spectra.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/0a03a17f6344305dd448c931ffc6f45d/plot_synthetic_power_spectra.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_synthetic_power_spectra.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018 - VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>